<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>&Ocy;&pcy;&icy;&scy;&acy;&ncy;&icy;&iecy; &bcy;&ocy;&tcy;&acy; &dcy;&lcy;&yacy; &icy;&gcy;&rcy;&ycy; &quot;&Kcy;&acy;&mcy;&iecy;&ncy;&softcy;-&Ncy;&ocy;&zhcy;&ncy;&icy;&tscy;&ycy;-&Bcy;&ucy;&mcy;&acy;&gcy;&acy;&quot;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-dark">
            <h1 id="описание-бота-для-игры-камень-ножницы-бумага">Описание бота для игры &quot;Камень-Ножницы-Бумага&quot;</h1>
<h2 id="основные-правила-и-понятия">Основные правила и понятия</h2>
<h3 id="игровые-элементы">Игровые элементы</h3>
<ul>
<li><strong>Возможные ходы</strong>: Камень, Бумага, Ножницы</li>
<li><strong>Результаты раундов</strong>: Победа, Поражение, Ничья</li>
<li><strong>Принцип побед</strong>:
<ul>
<li><strong>Камень</strong> побеждает <strong>Ножницы</strong></li>
<li><strong>Бумага</strong> побеждает <strong>Камень</strong></li>
<li><strong>Ножницы</strong> побеждают <strong>Бумагу</strong></li>
</ul>
</li>
</ul>
<h3 id="система-хранения-данных">Система хранения данных</h3>
<p>Бот ведет учет последних 1000 раундов, сохраняя:</p>
<ul>
<li>Последовательность ходов противника</li>
<li>Собственные выбранные ходы</li>
<li>Результаты каждого раунда</li>
</ul>
<h2 id="принцип-работы-системы-принятия-решений">Принцип работы системы принятия решений</h2>
<h3 id="инициализация-и-первый-ход">Инициализация и первый ход</h3>
<p>При первом обращении (когда от сервера приходит сигнал о начале игры с нулевым значением) система инициализируется и выбирает <strong>бумагу</strong> как свой первый ход. После получения первого хода противника, система уже имеет начальную точку для анализа - один завершенный раунд с известным результатом.</p>
<h3 id="алгоритм-принятия-решений-для-последующих-ходов">Алгоритм принятия решений для последующих ходов</h3>
<ol>
<li><strong>Запись данных</strong>: Сохранение последнего хода противника и вычисление результата предыдущего раунда</li>
<li><strong>Обновление счетчика поражений</strong>: При поражении счетчик увеличивается, при победе или ничьей сбрасывается</li>
<li><strong>Проверка смены метода</strong>: При достижении ровно 5 поражений подряд происходит переключение между методами анализа, счетчик сбрасывается</li>
<li><strong>Адаптация параметров</strong>: Анализ общего процента побед и корректировка внутренних параметров</li>
<li><strong>Предсказание</strong>: Прогнозирование следующего хода противника текущим активным методом</li>
<li><strong>Выбор ответа</strong>: Если метод дал прогноз - используется контр-ход, если нет - используется <strong>бумага</strong> по умолчанию</li>
<li><strong>Обновление истории</strong>: Сохранение собственного хода</li>
</ol>
<p><strong>Важно</strong>: Система НЕ переключается между методами при неудаче прогноза. Смена метода происходит ТОЛЬКО после 5 поражений подряд. Если текущий метод не может дать прогноз (недостаточно данных), система использует <strong>бумагу</strong> по умолчанию, но метод остается прежним.</p>
<h2 id="стратегии-анализа">Стратегии анализа</h2>
<p>Система использует два метода анализа поведения противника:</p>
<ul>
<li><strong>Метод 1</strong>: Поиск повторяющихся последовательностей (паттернов)</li>
<li><strong>Метод 2</strong>: Частотный анализ с весовой системой</li>
</ul>
<h3 id="метод-1-поиск-паттернов">Метод 1: Поиск паттернов</h3>
<p><strong>Требования</strong>: Минимум 5 сыгранных раундов в истории.</p>
<p><strong>Детальный процесс поиска</strong>:</p>
<p>Система работает по принципу &quot;от длинного к короткому&quot; - сначала ищет длинные совпадения, затем постепенно сокращает длину поиска.</p>
<p><strong>Этап 1: Выбор длины паттерна</strong></p>
<ul>
<li>Начинает с максимальной длины (от 6 до 14 ходов, по умолчанию 10)</li>
<li>Постепенно уменьшает до минимума 2 хода</li>
<li>На каждой длине проводит полный поиск по всей истории</li>
</ul>
<p><strong>Этап 2: Определение текущего паттерна</strong></p>
<ul>
<li>Берет последние N ходов противника как &quot;текущий паттерн&quot;</li>
<li>Например, если длина = 3, а последние ходы были [Камень, Бумага, Ножницы], то текущий паттерн = [Камень, Бумага, Ножницы]</li>
</ul>
<p><strong>Этап 3: Поиск совпадений в истории</strong></p>
<ul>
<li>Проходит по всей истории игры от начала до конца</li>
<li>Для каждой позиции проверяет: совпадает ли последовательность ходов с текущим паттерном посимвольно</li>
<li>Если находит полное совпадение И после этого совпадения есть еще хотя бы один ход - запоминает этот следующий ход</li>
</ul>
<p><strong>Пример поиска</strong>:</p>
<pre><code>История: [К, Б, Н, К, Б, Н, К, Б, Н]
Текущий паттерн (последние 3 хода): [К, Б, Н]

Поиск совпадений:
- Позиция 0: [К, Б, Н] == [К, Б, Н]? ✓ Совпадает! После был ход на позиции 3: К
- Позиция 1: [Б, Н, К] == [К, Б, Н]? ✗ Не совпадает
- Позиция 2: [Н, К, Б] == [К, Б, Н]? ✗ Не совпадает
- Позиция 3: [К, Б, Н] == [К, Б, Н]? ✓ Совпадает! После был ход на позиции 6: К
- ...и так далее
</code></pre>
<p><strong>Этап 4: Оценка каждого найденного совпадения</strong></p>
<p>Для каждого найденного совпадения вычисляется оценка по формуле:</p>
<pre><code>Базовая оценка = длина_паттерна × (2.0 + уровень_адаптации)

Модификация по результату раунда, который был ПОСЛЕ найденного паттерна:
- Если после паттерна бот ВЫИГРАЛ:  оценка + 10 баллов
- Если после паттерна была НИЧЬЯ:   оценка + 3 балла
- Если после паттерна бот ПРОИГРАЛ: оценка - 6 баллов
</code></pre>
<p><strong>Смысл оценки</strong>:</p>
<ul>
<li>Длинные паттерны ценнее (больше базовая оценка)</li>
<li>Паттерны, после которых бот выигрывал в прошлом, получают бонус</li>
<li>Паттерны, после которых бот проигрывал, получают штраф</li>
<li>Система запоминает <strong>лучший</strong> паттерн по оценке среди всех найденных совпадений данной длины</li>
</ul>
<p><strong>Этап 5: Проверка надежности</strong></p>
<p>После проверки всех позиций для текущей длины:</p>
<ul>
<li>Если лучшая оценка &gt;= 12 баллов - система считает прогноз надежным и немедленно возвращает предсказанный ход</li>
<li>Если оценка &lt; 12 - продолжает поиск с меньшей длиной паттерна</li>
</ul>
<p><strong>Этап 6: Финальное решение</strong></p>
<p>После проверки всех длин от максимальной до 2:</p>
<ul>
<li>Если нашелся хоть какой-то паттерн с положительной оценкой - используется лучший из них</li>
<li>Если ничего не найдено - возвращается &quot;нет прогноза&quot; (будет использована бумага по умолчанию)</li>
</ul>
<p><strong>Конкретный пример расчета</strong> (при уровне адаптации 0.6):</p>
<pre><code>Найден паттерн длины 3: [Камень, Бумага, Ножницы]
Базовая оценка = 3 × (2.0 + 0.6) = 3 × 2.6 = 7.8

Случай 1: После этого паттерна в прошлом бот выиграл
Финальная оценка = 7.8 + 10 = 17.8 ✓ (больше 12, используем сразу!)

Случай 2: После этого паттерна в прошлом бот проиграл
Финальная оценка = 7.8 - 6 = 1.8 ✗ (меньше 12, ищем дальше)

Случай 3: Найден паттерн длины 5 с ничьей
Базовая оценка = 5 × 2.6 = 13.0
Финальная оценка = 13.0 + 3 = 16.0 ✓ (отличный результат!)
</code></pre>
<p><strong>Важная деталь</strong>: Если один и тот же паттерн встречается несколько раз, система рассматривает каждое вхождение отдельно и выбирает то, которое дает лучшую оценку с учетом результата следующего хода.</p>
<h3 id="метод-2-частотный-анализ-с-весами">Метод 2: Частотный анализ с весами</h3>
<p><strong>Требования</strong>: Минимум 3 сыгранных раунда в истории.</p>
<p><strong>Окно анализа</strong>: Система анализирует последние 50-120 раундов (по умолчанию 80).</p>
<p><strong>Как работает</strong>:</p>
<p>Система присваивает каждому ходу вес по формуле:</p>
<pre><code>Фактор новизны = позиция_хода_в_окне / размер_окна
Базовый вес = 0.2 + фактор_новизны × 0.8

Итоговый вес = базовый_вес × (1.0 + уровень_адаптации)

Если после этого хода был проигрыш:
  вес умножается на 2
</code></pre>
<p><strong>Принцип весов</strong>:</p>
<ul>
<li>Старые ходы получают меньший вес (минимум 0.2)</li>
<li>Свежие ходы получают больший вес (максимум 1.0)</li>
<li>Все веса усиливаются уровнем адаптации (множитель от 1.4 до 2.0)</li>
<li>Если после хода противника бот проиграл, вес этого хода удваивается (система считает, что противник может повторить успешный ход)</li>
</ul>
<p><strong>Выбор прогноза</strong>: Система суммирует веса для Камня, Бумаги и Ножниц отдельно и выбирает тот ход, который набрал наибольший суммарный вес.</p>
<p><strong>Пример расчета</strong> (при уровне адаптации 0.6):</p>
<ul>
<li>Самый старый ход в окне: вес = 0.2 × 1.6 = 0.32</li>
<li>Самый новый ход: вес = 1.0 × 1.6 = 1.6</li>
<li>Если после хода был проигрыш: вес = 1.6 × 2.0 = 3.2</li>
</ul>
<h3 id="переключение-между-методами">Переключение между методами</h3>
<p><strong>Триггер переключения</strong>: 5 поражений подряд.</p>
<p><strong>Механизм</strong>:</p>
<ul>
<li>Система начинает с метода поиска паттернов</li>
<li>При каждом поражении увеличивается счетчик неудач</li>
<li>При достижении 5 поражений методы меняются местами</li>
<li>При победе или ничьей счетчик сбрасывается</li>
</ul>
<h2 id="адаптивная-настройка-параметров">Адаптивная настройка параметров</h2>
<h3 id="концепция">Концепция</h3>
<p>Система непрерывно отслеживает свою эффективность и автоматически настраивает три внутренних параметра после каждого хода.</p>
<h3 id="отслеживаемые-метрики">Отслеживаемые метрики</h3>
<p><strong>Процент побед</strong> = количество_побед / общее_количество_раундов</p>
<h3 id="настраиваемые-параметры">Настраиваемые параметры</h3>
<ol>
<li>
<p><strong>Уровень адаптации</strong> (от 0.4 до 1.0, старт: 0.6)</p>
<ul>
<li>Влияет на чувствительность оценки паттернов</li>
<li>Влияет на силу весов в частотном анализе</li>
</ul>
</li>
<li>
<p><strong>Максимальная длина паттернов</strong> (от 6 до 14, старт: 10)</p>
<ul>
<li>Определяет, насколько длинные последовательности искать</li>
</ul>
</li>
<li>
<p><strong>Размер окна анализа</strong> (от 50 до 120, старт: 80)</p>
<ul>
<li>Определяет, сколько последних раундов учитывать в частотном анализе</li>
</ul>
</li>
</ol>
<h3 id="режимы-адаптации">Режимы адаптации</h3>
<p><strong>При высокой эффективности (процент побед &gt; 60%)</strong>:</p>
<ul>
<li>Уровень адаптации увеличивается на 0.04</li>
<li>Длина паттернов увеличивается на 1</li>
<li>Окно анализа увеличивается на 8</li>
<li><em>Смысл</em>: Текущая стратегия работает хорошо, можно усилить агрессивность</li>
</ul>
<p><strong>При низкой эффективности (процент побед &lt; 45%)</strong>:</p>
<ul>
<li>Уровень адаптации уменьшается на 0.06</li>
<li>Длина паттернов уменьшается на 1</li>
<li>Окно анализа уменьшается на 10</li>
<li><em>Смысл</em>: Текущая стратегия не работает, нужно упростить подход</li>
</ul>
<p><strong>При длительной игре (более 150 раундов)</strong>:</p>
<ul>
<li>Если уровень адаптации выше 0.5, он уменьшается на 0.02</li>
<li><em>Смысл</em>: Предотвращение чрезмерной подстройки под конкретного противника</li>
</ul>
<h2 id="практические-примеры">Практические примеры</h2>
<h3 id="пример-1-противник-с-циклическим-паттерном">Пример 1: Противник с циклическим паттерном</h3>
<p><strong>Сценарий</strong>: Противник играет повторяющийся цикл &quot;Камень-Бумага-Ножницы-Камень-Бумага-Ножницы...&quot;</p>
<table>
<thead>
<tr>
<th>Раунд</th>
<th>Ход противника</th>
<th>Что происходит</th>
<th>Прогноз</th>
<th>Наш ход</th>
<th>Результат</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Камень</td>
<td>Инициализация, первый ход</td>
<td>-</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>2</td>
<td>Бумага</td>
<td>Недостаточно истории (1 завершенный раунд)</td>
<td>-</td>
<td>Бумага</td>
<td>Ничья</td>
</tr>
<tr>
<td>3</td>
<td>Ножницы</td>
<td>Недостаточно истории (2 раунда)</td>
<td>-</td>
<td>Бумага</td>
<td>Поражение</td>
</tr>
<tr>
<td>4</td>
<td>Камень</td>
<td>Недостаточно истории (3 раунда)</td>
<td>-</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>5</td>
<td>Бумага</td>
<td>Недостаточно истории (4 раунда)</td>
<td>-</td>
<td>Бумага</td>
<td>Ничья</td>
</tr>
<tr>
<td>6</td>
<td>Ножницы</td>
<td>Минимум достигнут (5 раундов). Ищем паттерны, но они еще слабые</td>
<td>Камень?</td>
<td>Бумага</td>
<td>Поражение</td>
</tr>
<tr>
<td>7</td>
<td>Камень</td>
<td>Найден паттерн [Камень,Бумага,Ножницы] длины 3, повторяется! После первого был Камень. Оценка: 3×2.6+10=17.8</td>
<td>Камень</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>8</td>
<td>Бумага</td>
<td>Паттерн [Бумага,Ножницы,Камень] повторяется. После был Бумага. Оценка высокая</td>
<td>Бумага</td>
<td>Ножницы</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>9</td>
<td>Ножницы</td>
<td>Паттерн [Ножницы,Камень,Бумага] повторяется. После был Ножницы. Оценка высокая</td>
<td>Ножницы</td>
<td>Камень</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>10</td>
<td>Камень</td>
<td>Длинные паттерны подтверждаются, цикл распознан</td>
<td>Камень</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
</tbody>
</table>
<h3 id="пример-2-противник-меняет-стратегию">Пример 2: Противник меняет стратегию</h3>
<p><strong>Сценарий</strong>: Противник сначала часто играет Камень (6 раз), затем переходит на Бумагу.</p>
<p><strong>Используется частотный анализ</strong> (допустим, переключились после неудач в предыдущей игре).</p>
<table>
<thead>
<tr>
<th>Раунд</th>
<th>Ход противника</th>
<th>Распределение весов</th>
<th>Прогноз</th>
<th>Наш ход</th>
<th>Результат</th>
</tr>
</thead>
<tbody>
<tr>
<td>6</td>
<td>Камень</td>
<td>Камень доминирует (6 ходов с весами 0.32-1.6, некоторые удвоены из-за проигрышей). Сумма весов: Камень ≈ 10, Бумага ≈ 0, Ножницы ≈ 0</td>
<td>Камень</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>7</td>
<td>Камень</td>
<td>Камень все еще доминирует (7 ходов). Последний имеет вес 1.6. Сумма: Камень ≈ 12, остальные ≈ 0</td>
<td>Камень</td>
<td>Бумага</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>8</td>
<td>Бумага</td>
<td>Камень: 7 старых ходов, Бумага: 1 новый ход (вес 1.6). Камень все еще впереди: К ≈ 10, Б ≈ 1.6</td>
<td>Камень</td>
<td>Бумага</td>
<td>Ничья</td>
</tr>
<tr>
<td>9</td>
<td>Бумага</td>
<td>Камень: 7 старых, Бумага: 2 новых (веса 1.4 и 1.6). Камень начинает терять вес: К ≈ 8, Б ≈ 3</td>
<td>Камень</td>
<td>Бумага</td>
<td>Ничья</td>
</tr>
<tr>
<td>10</td>
<td>Бумага</td>
<td>Бумага: 3 новых хода с высокими весами. Бумага начинает доминировать: Б ≈ 4.5, К ≈ 6</td>
<td>Камень</td>
<td>Бумага</td>
<td>Ничья</td>
</tr>
<tr>
<td>11</td>
<td>Ножницы</td>
<td>Бумага: 3 хода, Ножницы: 1 новый (вес 1.6). Б ≈ 4, Н ≈ 1.6, К ≈ 5</td>
<td>Камень</td>
<td>Бумага</td>
<td>Поражение</td>
</tr>
<tr>
<td>12</td>
<td>Бумага</td>
<td>Бумага: 4 новых хода. Бумага выходит вперед: Б ≈ 5.5, К ≈ 4, Н ≈ 1.3</td>
<td>Бумага</td>
<td>Ножницы</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>13</td>
<td>Бумага</td>
<td>Бумага: 5 новых ходов, явно доминирует: Б ≈ 7, К ≈ 3, Н ≈ 1</td>
<td>Бумага</td>
<td>Ножницы</td>
<td><strong>Победа</strong></td>
</tr>
<tr>
<td>14</td>
<td>Камень</td>
<td>Появился новый Камень (вес 1.6). Бумага пока впереди: Б ≈ 6, К ≈ 4, Н ≈ 1</td>
<td>Бумага</td>
<td>Ножницы</td>
<td>Поражение</td>
</tr>
<tr>
<td>15</td>
<td>Ножницы</td>
<td>Ножницы: 2 хода (последний × 2 от проигрыша = 3.2). Н ≈ 4.6, Б ≈ 5</td>
<td>Бумага или Ножницы</td>
<td>Ножницы</td>
<td>Ничья</td>
</tr>
</tbody>
</table>
<img src="file:////home/lsnko/Documents/Development/CompSci/labs/AutomataTheory/lab2/pics/flowchart.png" alt="Описание" width="95%">

            
            
        </body>
        </html>